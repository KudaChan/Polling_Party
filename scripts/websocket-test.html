<!DOCTYPE html>
<html>
<head>
    <title>Polling System WebSocket Test</title>
    <style>
        .message { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #dff0d8; }
        .error { background-color: #f2dede; }
    </style>
</head>
<body>
    <h2>Polling System WebSocket Test</h2>
    <div>
        <strong>Status: </strong>
        <span id="status">Connecting...</span>
    </div>
    <div>
        <h3>Messages:</h3>
        <div id="messages"></div>
    </div>

    <script>
        const ws = new WebSocket('ws://localhost:3000');
        const status = document.getElementById('status');
        const messages = document.getElementById('messages');

        function addMessage(text, isError = false) {
            const msg = document.createElement('div');
            msg.className = `message ${isError ? 'error' : 'success'}`;
            msg.textContent = `${new Date().toISOString()}: ${text}`;
            messages.insertBefore(msg, messages.firstChild);
        }

        ws.onopen = () => {
            status.textContent = 'Connected';
            status.style.color = 'green';
            addMessage('WebSocket connection established');
        };

        ws.onmessage = (event) => {
            try {
                const data = JSON.parse(event.data);
                addMessage(`Received: ${JSON.stringify(data, null, 2)}`);
            } catch (e) {
                addMessage(`Raw message: ${event.data}`, true);
            }
        };

        ws.onclose = () => {
            status.textContent = 'Disconnected';
            status.style.color = 'red';
            addMessage('WebSocket connection closed', true);
        };

        ws.onerror = (error) => {
            status.textContent = 'Error';
            status.style.color = 'red';
            addMessage(`WebSocket error: ${error.message}`, true);
        };
    </script>
</body>
</html>